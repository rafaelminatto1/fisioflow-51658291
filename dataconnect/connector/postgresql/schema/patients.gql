# Firebase Data Connect Schema: Patients
# Schema para gestão de pacientes no FisioFlow

"""
Tipo de paciente com informações demográficas e médicas
"""
type Patient @table {
  """
  Identificador único do paciente (UUID)
  """
  id: UUID! @default(uuid_generate_v4())

  """
  Nome completo do paciente
  """
  name: String!

  """
  CPF (documento de identidade brasileiro)
  """
  cpf: String @unique

  """
  Email de contato
  """
  email: String?

  """
  Telefone para contato
  """
  phone: String?

  """
  Data de nascimento
  """
  birth_date: DateTime?

  """
  Gênero: masculino, feminino, outro, prefiro_nao_dizer
  """
  gender: String?

  """
  Endereço completo em formato JSON
  """
  address: Json?

  """
  Contato de emergência em formato JSON
  """
  emergency_contact: Json?

  """
  Histórico médico relevante
  """
  medical_history: String?

  """
  Condição principal do paciente
  """
  main_condition: String?

  """
  Status do paciente: Inicial, Em_Tratamento, Recuperacao, Concluido
  """
  status: String @default("Inicial")

  """
  Progresso do tratamento (0-100)
  """
  progress: Int @default(0)

  """
  ID da organização/clínica
  """
  organization_id: UUID!

  """
  Indica se o paciente está ativo
  """
  is_active: Boolean @default(true)

  """
  Data e hora de criação do registro
  """
  created_at: DateTime! @default(now())

  """
  Data e hora da última atualização
  """
  updated_at: DateTime! @default(now())

  # Relações
  """
  Perfil do usuário vinculado (se aplicável)
  """
  profile: Profile @belongsTo

  """
  Prontuários médicos do paciente
  """
  medical_records: [MedicalRecord] @hasMany

  """
  Agendamentos do paciente
  """
  appointments: [Appointment] @hasMany

  """
  Planos de exercícios do paciente
  """
  exercise_plans: [ExercisePlan] @hasMany

  """
  Avaliações do paciente
  """
  assessments: [PatientAssessment] @hasMany

  """
  Sessões de tratamento do paciente
  """
  treatment_sessions: [TreatmentSession] @hasMany

  """
  Progresso do paciente
  """
  progress_records: [PatientProgress] @hasMany
}

# Queries para pacientes
"""
Input para filtro de pacientes
"""
input PatientFilterInput {
  """
  Filtrar por nome (busca parcial)
  """
  name: StringFilter

  """
  Filtrar por CPF exato
  """
  cpf: String

  """
  Filtrar por status
  """
  status: String

  """
  Filtrar por organização
  """
  organization_id: UUID

  """
  Filtrar apenas pacientes ativos
  """
  is_active: Boolean
}

"""
Tipo para paginação de pacientes
"""
type PatientPage {
  """
  Lista de pacientes
  """
  data: [Patient!]!

  """
  Total de registros encontrados
  """
  total: Int!

  """
  Número da página atual
  """
  page: Int!

  """
  Quantidade de registros por página
  """
  per_page: Int!
}
